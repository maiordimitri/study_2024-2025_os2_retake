---
## Author
author:
  name: Майоров Дмитрий Андреевич

## Title
title: Управление SELinux
---

# Цель работы

Получить навыки работы с контекстом безопасности и политиками SELinux.


# Выполнение лабораторной работы

Получаем полномочия администратора. Смотрим текущую информацию о SELinux. SELinux включен(enabled) и находится в принудительном режиме работы (enforcing). Тип политики: targeted. Конфигурационный режим: enforcing. Состояние политики: MS status не задан, deny_unknown разрешен. Проверка защиты памяти активна. Версия ядра политики: 33

![](image/img01.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Смотрим, в каком режиме работает SELinux.Он раюотает в принудительном режиме. Изменяем режим работы на разрешающий.

![](image/img02.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Открываем файл /etc/sysconfig/selinux для редактирования и устанавливаем следующий параметр. Перезагружаем систему

![](image/img03.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Смотрим статус SELinux. Видим, что он отключен. Пробуем переключить режим работы. Система говорит, что SELInux отключен. Мы не можем переключаться между отключённым и принудительным режимом без перезагрузки системы

![](image/img04.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Открываем файл /etc/sysconfig/selinux для редактирования и устанавливаем следующий параметр. Перезагружаем систему

![](image/img05.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Смотрим текущую информацию о SELinux. Убеждаемся, что он работает в принудительном режиме

![](image/img06.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Смотрм контекст безопасности файла /etc/hosts. Копируем его в домашний каталог. Проверяем контект файла. Параметр контекста изменился на admin_home_t

![](image/img07.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Пытаемся перезаписать существующий файл hosts из домашнего каталога в каталог /etc. Убеждаемся, что тип контекста по-прежнему установлен на admin_home_t

![](image/img08.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Исправляем контекст безопасности. Убеждаемся, что он изменился

![](image/img09.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Для массового исправления контекста безопасности на файловой системе ввоодим следующую команду и перезагружаем систему. При перезагрузке смотрим загрузочные сообщения. Видим, что файловая система перемаркирована

![](image/img10.jpg){#fig-001 width=70%}

![](image/img11.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Устанавливаем необходимое программное обеспечение

![](image/img12.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Создаем новое хранилище для файлов web-сервера. Создаем файл index.html 

![](image/img13.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Открываем этот файл для редактирования и помещаем туда следующий текст

![](image/img14.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

В файле /etc/httpd/conf/httpd.conf комментируем строку DocumentRoot "/var/www/html" и ниже добавляем строку DocumentRoot "/web"

![](image/img15.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Также ниже комментируем раздел и добавляем другой раздел, определяющий правила доступа

![](image/img16.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Запусткаем веб-сервер и службу httpd

![](image/img17.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Открваем веб-сервер в текстовом браузере. Видим страницу REd Hat по умолчанию

![](image/img18.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Применяем новую метку контекста к /web и восстанавливаем контекст безопастности

![](image/img19.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Перезагружаем систему и снова обращаемся к веб серверу. Теперь видим там запись, которую мы оставляли в файле index.html

![](image/img20.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Смотрим список переключателей SELinux для службы ftp

![](image/img21.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Для службы ftpd_anon смотрим список переключателей с пояснением, за что отвечает каждый переключатель, включён он или выключен

![](image/img22.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Изменяем текущее значение переключателя для службы ftpd_anon_write с off на on. Снова смотрим список переключателей для службы ftpd_anon. Смотрим список всех переключатателей

![](image/img23.jpg){#fig-001 width=70%}

# Выполнение лабораторной работы

Изменяем постоянное значение переключателя для службы ftpd_anon_write с off на on. Смотрим список переключателей. Видим, что переключатель включен



# Выводы

Получены навыки работы с контекстом безопасности и политиками SELinux.
